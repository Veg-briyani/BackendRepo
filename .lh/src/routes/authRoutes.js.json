{
    "sourceFile": "src/routes/authRoutes.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 3,
            "patches": [
                {
                    "date": 1741454157808,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                },
                {
                    "date": 1741454178706,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,9 +17,8 @@\n   getProfile,\n   updateProfile,\n   googleLogin\n } = require('../controllers/authController');\n-const { uploadProfile } = require('../config/multer');\n \n // Public routes\n router.post('/register', validateUser, register);\n router.post('/login', validateLogin, login);\n@@ -28,12 +27,7 @@\n router.post('/google-login', validateGoogleLogin, googleLogin);\n \n // Protected routes\n router.get('/profile', auth, getProfile);\n-router.put('/profile', \n-  auth, \n-  uploadProfile.single('profilePhoto'),\n-  validateProfileUpdate, \n-  updateProfile\n-);\n+router.put('/profile', auth, validateProfileUpdate, updateProfile);\n \n module.exports = router;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1741722164198,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,8 +17,10 @@\n   getProfile,\n   updateProfile,\n   googleLogin\n } = require('../controllers/authController');\n+const { User } = require('../models/user');\n+const { upload } = require('../middleware/upload');\n \n // Public routes\n router.post('/register', validateUser, register);\n router.post('/login', validateLogin, login);\n@@ -29,5 +31,32 @@\n // Protected routes\n router.get('/profile', auth, getProfile);\n router.put('/profile', auth, validateProfileUpdate, updateProfile);\n \n+router.post('/kyc', \n+  auth,\n+  upload.fields([\n+    { name: 'aadhaarFront', maxCount: 1 },\n+    { name: 'panCard', maxCount: 1 }\n+  ]),\n+  async (req, res) => {\n+    try {\n+      const updates = {\n+        aadhaarNumber: req.body.aadhaarNumber,\n+        panNumber: req.body.panNumber,\n+        kycStatus: 'pending'\n+      };\n+      \n+      const user = await User.findByIdAndUpdate(\n+        req.user._id,\n+        updates,\n+        { new: true, runValidators: true }\n+      ).select('-password -tokens');\n+      \n+      res.json({ message: 'KYC submitted for verification', user });\n+    } catch (error) {\n+      res.status(500).json({ message: 'KYC submission failed', error: error.message });\n+    }\n+  }\n+);\n+\n module.exports = router;\n\\ No newline at end of file\n"
                },
                {
                    "date": 1741722178942,
                    "content": "Index: \n===================================================================\n--- \n+++ \n@@ -17,10 +17,8 @@\n   getProfile,\n   updateProfile,\n   googleLogin\n } = require('../controllers/authController');\n-const { User } = require('../models/user');\n-const { upload } = require('../middleware/upload');\n \n // Public routes\n router.post('/register', validateUser, register);\n router.post('/login', validateLogin, login);\n@@ -31,32 +29,5 @@\n // Protected routes\n router.get('/profile', auth, getProfile);\n router.put('/profile', auth, validateProfileUpdate, updateProfile);\n \n-router.post('/kyc', \n-  auth,\n-  upload.fields([\n-    { name: 'aadhaarFront', maxCount: 1 },\n-    { name: 'panCard', maxCount: 1 }\n-  ]),\n-  async (req, res) => {\n-    try {\n-      const updates = {\n-        aadhaarNumber: req.body.aadhaarNumber,\n-        panNumber: req.body.panNumber,\n-        kycStatus: 'pending'\n-      };\n-      \n-      const user = await User.findByIdAndUpdate(\n-        req.user._id,\n-        updates,\n-        { new: true, runValidators: true }\n-      ).select('-password -tokens');\n-      \n-      res.json({ message: 'KYC submitted for verification', user });\n-    } catch (error) {\n-      res.status(500).json({ message: 'KYC submission failed', error: error.message });\n-    }\n-  }\n-);\n-\n module.exports = router;\n\\ No newline at end of file\n"
                }
            ],
            "date": 1741454157808,
            "name": "Commit-0",
            "content": "const express = require('express');\nconst router = express.Router();\nconst { auth } = require('../middleware/auth');\nconst { \n  validateUser, \n  validateLogin, \n  validateProfileUpdate,\n  validateForgotPassword,\n  validateResetPassword,\n  validateGoogleLogin\n} = require('../middleware/validation');\nconst {\n  register,\n  login,\n  forgotPassword,\n  resetPassword,\n  getProfile,\n  updateProfile,\n  googleLogin\n} = require('../controllers/authController');\nconst { uploadProfile } = require('../config/multer');\n\n// Public routes\nrouter.post('/register', validateUser, register);\nrouter.post('/login', validateLogin, login);\nrouter.post('/forgot-password', validateForgotPassword, forgotPassword);\nrouter.post('/reset-password', validateResetPassword, resetPassword);\nrouter.post('/google-login', validateGoogleLogin, googleLogin);\n\n// Protected routes\nrouter.get('/profile', auth, getProfile);\nrouter.put('/profile', \n  auth, \n  uploadProfile.single('profilePhoto'),\n  validateProfileUpdate, \n  updateProfile\n);\n\nmodule.exports = router;"
        }
    ]
}